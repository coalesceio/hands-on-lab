steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-cc4dd4e8-681f-43f8-9d1d-83d95f5286a7:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: e59619d4-b86e-4b98-b194-8732c2b322fa
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6496838f-654b-485d-ab8f-3e84244f65b4
                    stepCounter: 0d09c683-a86e-406b-826d-6410342365d6
                transform: ""
          - columnReference:
              columnCounter: 78934abc-c301-414c-9a74-779581e89d87
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b80655ae-2034-44a1-a978-59e8187c19fb
                    stepCounter: e7dc1080-0149-4710-b22c-858aa1735fcd
                transform: ""
          - columnReference:
              columnCounter: e35bd1a3-8a2c-44dd-b276-1fceab76507d
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2c6fc53e-b81e-47d4-b32d-97a465d44d1a
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 2554f6f9-c84a-42cb-b7e8-588b3411db68
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ce7edfb7-44c8-4f6b-8430-0fc589916afb
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 5e1b3775-3586-4def-b8a9-5a5faec93cef
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f68124e7-d41b-434b-9ceb-fbd00ca6062d
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: efa540ec-e617-4b2d-9c03-c5851620c215
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2a99ef98-ee05-41a7-aaa1-4bbaa37b163b
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: e600c8c1-d503-4f06-8b12-18ce6f15cea7
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6a42febc-2466-4f0f-ab6f-50b23a150864
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: dbf5f014-560e-45f3-9cd2-6b987f1b5ebc
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2445c9f6-494b-49f3-9114-80790649433d
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 3ef1a5b9-416c-4483-a76a-85efea30315e
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f764e9c2-d189-447d-bed9-c694fc2e4993
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 4c7cd5ed-bdd8-4a95-9c36-af8ea704e5d5
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 76269fd2-226a-4948-b58e-b9d48993c29b
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: a18195b4-b869-492c-8c1f-de8225d7f7a6
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 23f5f48d-c13e-4c21-b345-11f62562a71d
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: e374c1ce-f7da-4a80-a575-d5a44b2cc521
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b63d9770-6f90-4f8e-8085-06450845cff5
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: daa39c6b-d0be-45bb-85af-d1e917cfc21f
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d9d0478e-b603-45eb-9d2f-32f9dbf6d6e4
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 06020e42-b0c9-4781-90b8-0f56084d7469
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 102754a0-ae7b-451f-b7dd-5802a8f623ca
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: af160898-1bf4-4f54-afad-0572fb34ae14
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6f260b7b-e35a-4798-bd6a-c03c0ae20c0a
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 28659154-f236-4fe3-9745-3cbec6dd5246
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: aff209c7-bd4d-4c6b-8d5e-373b5118f30e
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 42b577d2-f62c-45fb-aab2-94dbfb427da4
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 773b8dff-f1fc-441d-b788-7cb5a3f21aee
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 8b6837e3-d8f0-47b2-90e2-97e34f92519c
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f53319e9-be12-4926-a82b-ae3be26318ed
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 3c2a41e3-d875-47f8-bc0c-6ddf26e2adc3
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 43c80bdf-93e5-4a6d-b170-5f0e9af5a1cc
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: fc8b1817-462c-4bbb-99f2-68f0fe853b07
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2128323e-3476-4980-a341-59e268167aed
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: b5327119-6866-4322-b8ff-a2ba7be420e5
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dbea499d-2b2a-42c8-89ab-d2c25403739e
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 6c9d28e7-4b35-4190-808f-1105b7633860
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 202cec07-a95a-4b05-a356-b065a87b0228
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 4541acf9-43f8-4076-9d2a-98b81cd822b4
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4ae20294-e999-4ab7-9546-3c5d7e22ae41
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: d52d6896-41e2-43e6-97e3-85495ed672d5
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 42c8db05-3cb5-4491-8b44-3078eb51c7a0
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 7e06a1f8-7f04-485d-9182-49c7e10c8de7
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 821b2777-5011-4584-8935-5e209f4d4936
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 98447375-85db-4632-b4b5-61a52425f1bf
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 332e48fc-399f-47cc-a23f-e2ce0db08bc9
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: e1f79b28-6b43-4faf-ac37-d94be67fd763
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d6cc3329-78d3-4af8-8157-88589c7e5b04
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 72726c38-c0c3-456e-a75e-5c602ca55b15
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 83ed4e6a-0158-4d73-bad1-2630c0b28c31
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - columnReference:
              columnCounter: 5e009504-0252-4948-b68e-73bc944f41a7
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: days_to_ship
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 80250be4-5952-4057-ad1b-696721fc3234
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4786aebb-babc-47bc-b44a-82ddfb43a8c3
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bd2870f5-4cca-4751-8cea-9b354d1f81b3
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: bd807c2f-b8d5-485b-88fa-a56d5e7275f9
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2ee032a3-a3d0-4f45-bd9d-d02dfc044c0d
                    stepCounter: e5875d1c-75a9-4db3-b103-3e0238c7ab94
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 550d9657-1a72-41b8-8cf2-13c7a2cdbc94
              DIM_PART: 0d09c683-a86e-406b-826d-6410342365d6
              DIM_SUPPLIER: e7dc1080-0149-4710-b22c-858aa1735fcd
              STG_LINEITEM_ORDERS: 4d92caad-633f-4968-875a-68dabd097f3f
              STG_PARTSUPP: 2d16b445-55eb-4979-af76-b576061ce2f2
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"

                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"

                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"

                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"

                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */

                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"

                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"

                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"

                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND

                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
