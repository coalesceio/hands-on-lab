steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-cc4dd4e8-681f-43f8-9d1d-83d95f5286a7:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 2debe365-6101-4671-8480-59fea502c725
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1d37f82b-62f1-480f-83d8-6489462af02e
                    stepCounter: 550d9657-1a72-41b8-8cf2-13c7a2cdbc94
                transform: ""
          - columnReference:
              columnCounter: e59619d4-b86e-4b98-b194-8732c2b322fa
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6496838f-654b-485d-ab8f-3e84244f65b4
                    stepCounter: 0d09c683-a86e-406b-826d-6410342365d6
                transform: ""
          - columnReference:
              columnCounter: 78934abc-c301-414c-9a74-779581e89d87
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b80655ae-2034-44a1-a978-59e8187c19fb
                    stepCounter: e7dc1080-0149-4710-b22c-858aa1735fcd
                transform: ""
          - columnReference:
              columnCounter: e35bd1a3-8a2c-44dd-b276-1fceab76507d
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 16b833b0-6db3-4fb0-84c4-1b0ab896543f
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 2554f6f9-c84a-42cb-b7e8-588b3411db68
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f90aceea-bab5-46f1-82ea-4f79702e0694
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 5e1b3775-3586-4def-b8a9-5a5faec93cef
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3a5d5b85-9cae-4999-93b1-f9167d49979d
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: efa540ec-e617-4b2d-9c03-c5851620c215
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ed632e99-2c52-403c-a31b-bb5997e39527
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: e600c8c1-d503-4f06-8b12-18ce6f15cea7
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 70ac78f2-cd8a-4e2e-baf4-74ef629f375d
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: dbf5f014-560e-45f3-9cd2-6b987f1b5ebc
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a30969af-7c93-4c88-9bf2-18e566e870d2
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 3ef1a5b9-416c-4483-a76a-85efea30315e
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f9d02add-94d1-4ad7-83be-c69b0949dc7a
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 4c7cd5ed-bdd8-4a95-9c36-af8ea704e5d5
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 378ac719-929a-423f-83a1-ef753998a133
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: a18195b4-b869-492c-8c1f-de8225d7f7a6
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 791319c2-be67-4446-866e-7c8839573ac5
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: e374c1ce-f7da-4a80-a575-d5a44b2cc521
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 26e5a89f-1efa-4eb1-ad2d-70d6028345ce
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: daa39c6b-d0be-45bb-85af-d1e917cfc21f
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 17fab8f1-90ef-4811-9585-8a3e0095b71c
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 06020e42-b0c9-4781-90b8-0f56084d7469
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 273d83bb-816f-401a-9ca2-569ab1c94b94
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: af160898-1bf4-4f54-afad-0572fb34ae14
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a89af331-589e-40f7-81cd-f99c56ce5d59
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 28659154-f236-4fe3-9745-3cbec6dd5246
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3df2067e-8906-456f-a97f-afaa715cad7d
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 42b577d2-f62c-45fb-aab2-94dbfb427da4
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b6d16cb8-f738-4acc-b674-1604e2875581
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 8b6837e3-d8f0-47b2-90e2-97e34f92519c
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2d666a44-496b-4734-9836-315eee73c304
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 3c2a41e3-d875-47f8-bc0c-6ddf26e2adc3
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(50)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0637bdac-1265-4a84-bb67-b1de2136f4f0
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: fc8b1817-462c-4bbb-99f2-68f0fe853b07
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cc286861-9f95-454b-9c69-509d266bd465
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: b5327119-6866-4322-b8ff-a2ba7be420e5
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f68f72ba-f3e4-441d-ba63-af7c06673416
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 6c9d28e7-4b35-4190-808f-1105b7633860
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: abe8c337-ef22-4e98-9f21-dc1d616736d2
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 4541acf9-43f8-4076-9d2a-98b81cd822b4
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4fa765fd-a0e0-4716-a164-8e53d32ac5c1
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: d52d6896-41e2-43e6-97e3-85495ed672d5
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b34bf769-ba6c-439e-b8b5-0eee2b4d89b8
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 7e06a1f8-7f04-485d-9182-49c7e10c8de7
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ee80b3bb-28b5-4320-8dd1-f2d75d1d517e
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 98447375-85db-4632-b4b5-61a52425f1bf
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 64a3a7c2-a6dc-4f15-a9e4-d80e904f71ef
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: e1f79b28-6b43-4faf-ac37-d94be67fd763
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e51efa64-7bb0-4f23-9591-98ba884e5958
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 72726c38-c0c3-456e-a75e-5c602ca55b15
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: VARCHAR(80)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9277cbb4-7051-4f45-a92e-7ffb93e71876
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - columnReference:
              columnCounter: 5e009504-0252-4948-b68e-73bc944f41a7
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: days_to_ship
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c29352b8-48fc-434f-a335-6a55c1bb08d5
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4786aebb-babc-47bc-b44a-82ddfb43a8c3
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f3fcaaa9-fe62-457a-bd31-6dc85e772713
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: bd807c2f-b8d5-485b-88fa-a56d5e7275f9
              stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8a19f541-63ff-46a4-9580-158dbcade8fa
                    stepCounter: 4d92caad-633f-4968-875a-68dabd097f3f
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              STG_LINEITEM_ORDERS: 4d92caad-633f-4968-875a-68dabd097f3f
              STG_PARTSUPP: 2d16b445-55eb-4979-af76-b576061ce2f2
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"

                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"

                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"

                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"

                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */

                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"

                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"

                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"

                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND

                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: cc4dd4e8-681f-43f8-9d1d-83d95f5286a7
